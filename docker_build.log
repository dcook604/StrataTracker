db uses an image, skipping
Building backend
#0 building with "default" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 909B done
#1 DONE 0.1s

#2 [internal] load metadata for docker.io/library/node:18-alpine
#2 DONE 0.4s

#3 [internal] load .dockerignore
#3 transferring context: 138B done
#3 DONE 0.1s

#4 [internal] load build context
#4 DONE 0.0s

#5 [builder  1/11] FROM docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e
#5 resolve docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e 0.0s done
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 4.19MB / 40.01MB 0.1s
#5 sha256:1e5a4c89cee5c0826c540ab06d4b6b491c96eda01837f430bd47f0d26702d6e3 0B / 1.26MB 0.1s
#5 sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e 7.67kB / 7.67kB done
#5 sha256:929b04d7c782f04f615cf785488fed452b6569f87c73ff666ad553a7554f0006 1.72kB / 1.72kB done
#5 sha256:ee77c6cd7c1886ecc802ad6cedef3a8ec1ea27d1fb96162bf03dd3710839b8da 6.18kB / 6.18kB done
#5 sha256:f18232174bc91741fdf3da96d85011092101a032a93a388b79e99e69c2d5c870 0B / 3.64MB 0.1s
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 17.18MB / 40.01MB 0.2s
#5 sha256:1e5a4c89cee5c0826c540ab06d4b6b491c96eda01837f430bd47f0d26702d6e3 1.26MB / 1.26MB 0.2s
#5 sha256:f18232174bc91741fdf3da96d85011092101a032a93a388b79e99e69c2d5c870 3.64MB / 3.64MB 0.2s
#5 extracting sha256:f18232174bc91741fdf3da96d85011092101a032a93a388b79e99e69c2d5c870
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 32.51MB / 40.01MB 0.3s
#5 sha256:1e5a4c89cee5c0826c540ab06d4b6b491c96eda01837f430bd47f0d26702d6e3 1.26MB / 1.26MB 0.2s done
#5 sha256:f18232174bc91741fdf3da96d85011092101a032a93a388b79e99e69c2d5c870 3.64MB / 3.64MB 0.2s done
#5 sha256:25ff2da83641908f65c3a74d80409d6b1b62ccfaab220b9ea70b80df5a2e0549 446B / 446B 0.3s done
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 40.01MB / 40.01MB 0.4s
#5 ...

#4 [internal] load build context
#4 transferring context: 1.14MB 0.4s done
#4 DONE 0.6s

#5 [builder  1/11] FROM docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e
#5 extracting sha256:f18232174bc91741fdf3da96d85011092101a032a93a388b79e99e69c2d5c870 0.3s done
#5 extracting sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e
#5 sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 40.01MB / 40.01MB 0.6s done
#5 extracting sha256:dd71dde834b5c203d162902e6b8994cb2309ae049a0eabc4efea161b2b5a3d0e 3.8s done
#5 extracting sha256:1e5a4c89cee5c0826c540ab06d4b6b491c96eda01837f430bd47f0d26702d6e3
#5 extracting sha256:1e5a4c89cee5c0826c540ab06d4b6b491c96eda01837f430bd47f0d26702d6e3 0.1s done
#5 extracting sha256:25ff2da83641908f65c3a74d80409d6b1b62ccfaab220b9ea70b80df5a2e0549 done
#5 DONE 5.2s

#6 [builder  2/11] WORKDIR /app
#6 DONE 1.0s

#7 [builder  3/11] COPY package*.json ./
#7 DONE 0.1s

#8 [builder  4/11] COPY tsconfig.json ./
#8 DONE 0.1s

#9 [stage-1 3/8] RUN mkdir -p ./dist/public
#9 ...

#10 [builder  5/11] COPY vite.config.ts ./
#10 DONE 0.2s

#9 [stage-1 3/8] RUN mkdir -p ./dist/public
#9 DONE 0.4s

#11 [builder  6/11] COPY server ./server
#11 DONE 0.1s

#12 [stage-1 4/8] RUN mkdir -p ./node_modules
#12 ...

#13 [builder  7/11] COPY shared ./shared
#13 DONE 0.1s

#14 [builder  8/11] COPY client ./client
#14 DONE 0.1s

#12 [stage-1 4/8] RUN mkdir -p ./node_modules
#12 DONE 0.4s

#15 [builder  9/11] RUN npm install
#15 9.360 npm warn deprecated @esbuild-kit/esm-loader@2.6.5: Merged into tsx: https://tsx.is
#15 9.394 npm warn deprecated @esbuild-kit/core-utils@3.3.2: Merged into tsx: https://tsx.is
#15 21.21 
#15 21.21 added 534 packages, and audited 535 packages in 21s
#15 21.21 
#15 21.21 69 packages are looking for funding
#15 21.21   run `npm fund` for details
#15 21.29 
#15 21.29 7 moderate severity vulnerabilities
#15 21.29 
#15 21.29 To address issues that do not require attention, run:
#15 21.29   npm audit fix
#15 21.29 
#15 21.29 To address all issues (including breaking changes), run:
#15 21.29   npm audit fix --force
#15 21.29 
#15 21.29 Run `npm audit` for details.
#15 21.29 npm notice
#15 21.29 npm notice New major version of npm available! 10.8.2 -> 11.4.1
#15 21.29 npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.4.1
#15 21.29 npm notice To update run: npm install -g npm@11.4.1
#15 21.29 npm notice
#15 DONE 25.4s

#16 [builder 10/11] RUN ls -la client # Debug: List files in /app/client to verify index.html presence
#16 0.395 total 24
#16 0.395 drwxr-xr-x    4 root     root          4096 May 25 21:46 .
#16 0.395 drwxr-xr-x    1 root     root          4096 May 25 22:05 ..
#16 0.395 -rw-rw-r--    1 root     root          1783 May 25 20:33 index.html
#16 0.395 drwxrwxr-x    2 root     root          4096 May 25 20:33 public
#16 0.395 drwxrwxr-x    6 root     root          4096 May 25 20:33 src
#16 DONE 0.4s

#17 [builder 11/11] RUN npm run build
#17 0.992 
#17 0.992 > rest-express@1.0.0 build
#17 0.992 > npm run check-conflicts && vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist
#17 0.992 
#17 1.282 
#17 1.282 > rest-express@1.0.0 check-conflicts
#17 1.282 > find . -type f \( -name '*.tsx' -o -name '*.ts' -o -name '*.jsx' -o -name '*.js' \) -exec grep -H '<<<<<<< HEAD' {} + || true
#17 1.282 
#17 7.478 vite v5.4.14 building for production...
#17 7.597 transforming...
#17 24.08 âœ“ 2892 modules transformed.
#17 25.55 rendering chunks...
#17 25.60 computing gzip size...
#17 25.81 ../dist/public/index.html                     1.88 kB â”‚ gzip:   0.81 kB
#17 25.81 ../dist/public/assets/index-B2MAaKPm.css      1.30 kB â”‚ gzip:   0.45 kB
#17 25.81 ../dist/public/assets/index-3-HCJIwz.js   2,002.88 kB â”‚ gzip: 723.81 kB
#17 25.81 
#17 25.81 (!) Some chunks are larger than 500 kB after minification. Consider:
#17 25.81 - Using dynamic import() to code-split the application
#17 25.81 - Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
#17 25.81 - Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
#17 25.81 âœ“ built in 18.29s
#17 25.97 
#17 25.97   dist/index.js  150.6kb
#17 25.97 
#17 25.97 âš¡ Done in 45ms
#17 DONE 26.1s

#18 [stage-1 5/8] COPY --from=builder /app/package*.json ./
#18 DONE 0.5s

#19 [stage-1 6/8] COPY --from=builder /app/dist ./dist/
#19 DONE 0.1s

#20 [stage-1 7/8] COPY --from=builder /app/dist/public ./dist/public/
#20 DONE 0.1s

#21 [stage-1 8/8] COPY --from=builder /app/node_modules ./node_modules/
#21 DONE 6.7s

#22 exporting to image
#22 exporting layers
#22 exporting layers 9.8s done
#22 writing image sha256:cb9afe24b93451e96810ccb5b39d5076ad2abe13acc131818c553cbd782e5f2f done
#22 naming to docker.io/library/violation_backend done
#22 DONE 9.8s
The Docker Engine you're using is running in swarm mode.

Compose does not use swarm mode to deploy services to multiple nodes in a swarm. All containers will be scheduled on the current node.

To deploy your application across the swarm, use `docker stack deploy`.

Creating network "violation_default" with the default driver
Pulling db (postgres:15)...
15: Pulling from library/postgres
Digest: sha256:f57a3bdbf044f0b213fdc99f35a0d21c401608bf41f063176ec00c51df9655f7
Status: Downloaded newer image for postgres:15
Creating violation_db_1 ... 
Creating violation_db_1 ... done
Creating violation_backend_1 ... 
Creating violation_backend_1 ... done
Attaching to violation_db_1, violation_backend_1
[33mdb_1       |[0m 
[33mdb_1       |[0m PostgreSQL Database directory appears to contain a database; Skipping initialization
[33mdb_1       |[0m 
[33mdb_1       |[0m 2025-05-25 22:07:03.184 UTC [1] LOG:  starting PostgreSQL 15.13 (Debian 15.13-1.pgdg120+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
[33mdb_1       |[0m 2025-05-25 22:07:03.185 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
[33mdb_1       |[0m 2025-05-25 22:07:03.185 UTC [1] LOG:  listening on IPv6 address "::", port 5432
[33mdb_1       |[0m 2025-05-25 22:07:03.188 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
[33mdb_1       |[0m 2025-05-25 22:07:03.194 UTC [29] LOG:  database system was shut down at 2025-05-25 22:02:51 UTC
[33mdb_1       |[0m 2025-05-25 22:07:03.206 UTC [1] LOG:  database system is ready to accept connections
[36mbackend_1  |[0m [36m[LOGGER] Debug logging enabled. Log level: INFO[0m
[36mbackend_1  |[0m [36m[LOGGER] Log files will be written to: /app/logs[0m
[36mbackend_1  |[0m [32m[2025-05-25T22:07:04.862Z] [INFO] Setting up database connection...[0m
[36mbackend_1  |[0m [32m[2025-05-25T22:07:04.863Z] [INFO] Database connection string (masked): postgres://spectrum4:****@db:5432/spectrum4[0m
[36mbackend_1  |[0m [32m[2025-05-25T22:07:04.868Z] [INFO] Drizzle ORM initialized successfully[0m
[36mbackend_1  |[0m node:internal/errors:496
[36mbackend_1  |[0m     ErrorCaptureStackTrace(err);
[36mbackend_1  |[0m     ^
[36mbackend_1  |[0m 
[36mbackend_1  |[0m TypeError [ERR_INVALID_ARG_TYPE]: The "paths[0]" argument must be of type string. Received undefined
[36mbackend_1  |[0m     at new NodeError (node:internal/errors:405:5)
[36mbackend_1  |[0m     at validateString (node:internal/validators:162:11)
[36mbackend_1  |[0m     at Object.resolve (node:path:1115:7)
[36mbackend_1  |[0m     at file:///app/dist/index.js:3699:18
[36mbackend_1  |[0m     at ModuleJob.run (node:internal/modules/esm/module_job:195:25)
[36mbackend_1  |[0m     at async ModuleLoader.import (node:internal/modules/esm/loader:337:24)
[36mbackend_1  |[0m     at async loadESM (node:internal/process/esm_loader:34:7)
[36mbackend_1  |[0m     at async handleMainPromise (node:internal/modules/run_main:106:12) {
[36mbackend_1  |[0m   code: 'ERR_INVALID_ARG_TYPE'
[36mbackend_1  |[0m }
[36mbackend_1  |[0m 
[36mbackend_1  |[0m Node.js v18.20.8
[36mviolation_backend_1 exited with code 1
[0m[33mdb_1       |[0m 2025-05-25 22:12:03.232 UTC [27] LOG:  checkpoint starting: time
[33mdb_1       |[0m 2025-05-25 22:12:03.252 UTC [27] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.004 s, sync=0.004 s, total=0.021 s; sync files=2, longest=0.002 s, average=0.002 s; distance=0 kB, estimate=0 kB
[33mdb_1       |[0m 2025-05-25 22:22:21.070 UTC [1] LOG:  received fast shutdown request
[33mdb_1       |[0m 2025-05-25 22:22:21.074 UTC [1] LOG:  aborting any active transactions
[33mdb_1       |[0m 2025-05-25 22:22:21.077 UTC [1] LOG:  background worker "logical replication launcher" (PID 32) exited with exit code 1
[33mdb_1       |[0m 2025-05-25 22:22:21.081 UTC [27] LOG:  shutting down
[33mdb_1       |[0m 2025-05-25 22:22:21.084 UTC [27] LOG:  checkpoint starting: shutdown immediate
[33mdb_1       |[0m 2025-05-25 22:22:21.099 UTC [27] LOG:  checkpoint complete: wrote 0 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.001 s, sync=0.001 s, total=0.019 s; sync files=0, longest=0.000 s, average=0.000 s; distance=0 kB, estimate=0 kB
[33mdb_1       |[0m 2025-05-25 22:22:21.110 UTC [1] LOG:  database system is shut down
[33mviolation_db_1 exited with code 0
[0m